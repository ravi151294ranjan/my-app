<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: models/reportModel.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: models/reportModel.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * ReportModel to perform report operations through Report module ..
 * @module Report Model
 * @see {@link Report}
 */
var ObjectID = require('mongodb').ObjectID;

module.exports = {

    /**
    * In getReportDatafrombundel method to create report data.&lt;br>
    * @param  {string} collectionName Its show the collection name.
    * @param  {string} data Its contains all report data.
    * @return {Object} Its return success or failure message based on data insertion.
    */

    getReportDatafrombundel: (collectionName, data) => {
        let db = global.db;
        return new Promise((resolve, reject) => {
            const beginnerRangeValue = { min: Number(data.beginnerRange.min), max: Number(data.beginnerRange.max) }
            const intermediateRangeValue = { min: Number(data.intermediateRange.min), max: Number(data.intermediateRange.max) }
            const expertRangeValue = { min: Number(data.expertRange.min), max: Number(data.expertRange.max) }
            let dataFormation = {}
            dataFormation = {
                scenarioName: data.scenarioName,
                userName: data.userName,
                timeAllocatedValue: Number(data.timeAllocatedValue),
                timeTakenValue: Number(data.timeTakenValue),
                totalAttemptsCount: Number(data.totalAttemptsCount),
                beginnerRange: beginnerRangeValue,
                intermediateRange: intermediateRangeValue,
                expertRange: expertRangeValue,
                isSkillMeterTransition: data.isSkillMeterTransition,
                isBarTransition: data.isBarTransition,
                configCount: Number(data.attmeptsData.configCount),
                isAttemptsPanelTransition: data.isAttemptsPanelTransition
            }
            let vAttemptData = []
            let warrningCount = 0
            for (let i = 0; i &lt; Number(data.attmeptsData.configCount); i++) {
                let dataextrastep = 0
                if (data.attmeptsData.extraSteps[i] !== undefined) {
                    dataextrastep = data.attmeptsData.extraSteps[i]
                    warrningCount += data.attmeptsData.extraSteps[i]
                }
                vAttemptData.push({
                    step: `Configuration ${i + 1}`,
                    timeTaken: Number(data.attmeptsData.timeTakenList[i]),
                    attemptsCount: Number(data.attmeptsData.attemptsCountList[i]),
                    extraSteps: Number(dataextrastep)
                })
            }
            dataFormation['AttemptsData'] = vAttemptData
            dataFormation['warrningCount'] = warrningCount
            db.collection(collectionName).insertOne(dataFormation, (err, dataval) => {
                if (err) { reject(err) }
                else {
                    let result = {
                        success: true,
                        status: 200,
                        message: "report created successful!"
                    }
                    resolve(result)
                }
            })
        })
    },

    /**
    * In getUserbasedScenarioList method to get scenario list.
    * @param  {string} collectionName Its show the collection name.
    * @param  {string} data Its contains selected group id to get scenario list.
    * @return {Object} Its return success or failure message with scenario list.
    */
    getUserbasedScenarioList: (collectionName, data) => {
        let db = global.db;
        return new Promise((resolve, reject) => {
            db.collection(collectionName).find({ SelectedGroup: { $in: data.SelectedGroup } }).sort({ Title: 1 }).toArray((err, res) => {
                if (err) { reject(err) }
                if (res.length == 0) {
                    let result = {
                        message: "Scenario not found."
                    }
                    resolve(result)
                } else {
                    resolve(res)
                }
            })
        })
    },


    /**
    * In getScenarioBasedReport method to get scenario based report.
    * @param  {string} collectionName Its show the collection name.
    * @param  {string} data Its contains selected group id.
    * @return {Object} Its return success or failure message with scenario based records.
    */
    getScenarioBasedReport: (collectionName, data) => {
        let db = global.db;
        return new Promise((resolve, reject) => {
            db.collection(collectionName).find({
                scenarioId: ObjectID(data.scenarioId),
                userid: ObjectID(data.userid)
            }).toArray((err, res) => {
                if (err) { reject(err) }
                if (res.length == 0) {
                    let result = {
                        success: false,
                        status: 403,
                        message: 'Report not found'
                    }
                    resolve(result)
                } else {
                    let result = {
                        success: true,
                        status: 200,
                        message: 'Success!',
                        data: res
                    }
                    resolve(result)
                }
            })
        })
    },


    /**
* In getStremingAssetDAta method to get streaming data.
* @param  {string} collectionName Its show the collection name.
* @param  {string} data Its contains scenario id.
* @return {Object} Its return success or failure message with scenario streming data.
*/
    getStremingAssetDAta: (collectionName, id) => {
        let db = global.db;
        return new Promise((resolve, reject) => {
            db.collection(collectionName).find({ _id: ObjectID(id) },
                {
                    projection: {
                        createdAt: 0, createdBy: 0,
                        SelectedGroup: 0, updatedAt: 0,
                        updatedBy: 0, shortUrl: 0,
                    }
                }).toArray((err, resdata) => {
                    if (err) { reject(err) }
                    if (resdata.length == 0) {
                        let result = {
                            message: "Streaming Scenario data not found."
                        }
                        resolve(result)
                    } else {
                        resolve(resdata[0])
                    }
                })
        })
    },

}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AdminDetails.html">AdminDetails</a></li><li><a href="module-Appconfig.html">Appconfig</a></li><li><a href="module-Asset%2520Model.html">Asset Model</a></li><li><a href="module-Assetmanage.html">Assetmanage</a></li><li><a href="module-AuthMiddleware.html">AuthMiddleware</a></li><li><a href="module-dashboard.html">dashboard</a></li><li><a href="module-DB%2520Connection.html">DB Connection</a></li><li><a href="module-ErrorLog.html">ErrorLog</a></li><li><a href="module-forgot%2520Model.html">forgot Model</a></li><li><a href="module-forgotPwd.html">forgotPwd</a></li><li><a href="module-Group.html">Group</a></li><li><a href="module-Group%2520Model.html">Group Model</a></li><li><a href="module-Register.html">Register</a></li><li><a href="module-Report.html">Report</a></li><li><a href="module-Report%2520Model.html">Report Model</a></li><li><a href="module-Scenario.html">Scenario</a></li><li><a href="module-Scenario%2520Model.html">Scenario Model</a></li><li><a href="module-ScenarioUser.html">ScenarioUser</a></li><li><a href="module-sendEmail%2520Model.html">sendEmail Model</a></li><li><a href="module-ShorturlGet.html">ShorturlGet</a></li><li><a href="module-SuperAdmin.html">SuperAdmin</a></li><li><a href="module-TenantDetails.html">TenantDetails</a></li><li><a href="module-TokenGenration.html">TokenGenration</a></li><li><a href="module-Upload.html">Upload</a></li><li><a href="module-URLShortner.html">URLShortner</a></li><li><a href="module-User.html">User</a></li><li><a href="module-User%252520Model.html">User Model</a></li><li><a href="module-WEBGL%2520Model.html">WEBGL Model</a></li></ul><h3>Global</h3><ul><li><a href="global.html#getAllAssetForUnity">getAllAssetForUnity</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Wed Jun 02 2021 15:41:57 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
