<div class="container">
<!-- [style]="(!showCreateChapterForm) ? 'display:block;' : 'display:none;'" -->
  <div class="row"*ngIf="!showCreateChapterForm" >
    <div class="col-12">
      <div class="title">Video Content</div>
      <form [formGroup]="addContentForm" (ngSubmit)="createNewContent()">

        <div class="row justify-content-center">
          <div class="col-6">
            <div>
              <label>Title</label><span class="error_msg"> * </span>
              <div class="form-group">
                <input maxlength="50" placeholder="Enter title" type="text" formControlName="title"
                  class="form-control"
                  [ngClass]="{ 'is-invalid': contentSubmitted && addContentFormData.title.errors }" />
                <div *ngIf="contentSubmitted && addContentFormData.title.errors" class="invalid-feedback">
                  <div *ngIf="addContentFormData.title.errors.required">Content Title is required</div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-6">
            <div>
              <label>Upload Video Content</label><span class="error_msg"> * </span>
              <div class="form-group">
                <input style="display: inline;width: 75%;" class="form-control" type="text" readonly
                  placeholder="Uploaded file name" formControlName="uploadedVideoContent"
                  [ngClass]="{ 'is-invalid': contentSubmitted && addContentFormData.uploadedVideoContent.errors }" />

                <div *ngIf="contentSubmitted && addContentFormData.uploadedVideoContent.errors"
                  class="invalid-feedback">
                  <div *ngIf="addContentFormData.uploadedVideoContent.errors.required">Upload Video content</div>
                </div>

                <label class="btn btn-danger-themed float-right" [style]="pointerEvents" for="contentVideo">Upload</label>
                <input id="contentVideo" style="display:none;" type="file" accept="video/*"
                  formControlName="contentVideo" (change)="uploadVideoFile($event)" />
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-12">
            <label>Description</label><span class="error_msg"> * </span>

            <div class="form-group">
              <ckeditor #contentDesc maxlength="5000" formControlName="description" name="description"
                language="en" [config]="ckEditorConfig"
                [ngClass]="{ 'is-invalid': contentSubmitted && addContentFormData.description.errors }">
              </ckeditor>
              
              <div *ngIf="contentSubmitted && addContentFormData.description.errors" class="invalid-feedback">
                <div *ngIf="addContentFormData.description.errors.required">Description is required</div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-6">
            <label>Language</label><span class="error_msg"> * </span>

            <div class="form-group">
              <ng-select [clearable]="false" formControlName="language" class="form-control"
                placeholder="Select Language">
                <ng-option value="English">English</ng-option>
                <ng-option value="Spanish">Spanish</ng-option>
              </ng-select>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-6 offset-6">
            <div class="form-group">
              <button class="float-right btn btn-primary-themed" [disabled]="addContentForm.invalid"
                type="submit">Next</button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
  <!--  -->
  <!-- [style]="(showCreateChapterForm) ? 'display:block;' : 'display:none;'" -->
  <div *ngIf="showCreateChapterForm" >
    <div class="row">
      <div class="col-8">
        <vg-player>
          <vg-overlay-play></vg-overlay-play>
          <vg-buffering></vg-buffering>

          <vg-scrub-bar>
            <vg-scrub-bar-current-time></vg-scrub-bar-current-time>
            <vg-scrub-bar-buffering-time></vg-scrub-bar-buffering-time>
          </vg-scrub-bar>

          <vg-controls>
            <vg-play-pause></vg-play-pause>
            <vg-playback-button></vg-playback-button>

            <vg-time-display vgProperty="current" vgFormat="mm:ss"></vg-time-display>

            <vg-scrub-bar style="pointer-events: none;"></vg-scrub-bar>

            <vg-time-display vgProperty="left" vgFormat="mm:ss"></vg-time-display>

            <!-- <vg-track-selector></vg-track-selector> -->
            <vg-mute></vg-mute>
            <vg-volume></vg-volume>
            <vg-time-display vgProperty="total" vgFormat="mm:ss"></vg-time-display>

          </vg-controls>

          <video [vgMedia]="media" #media id="singleVideo" preload="auto" crossorigin>
            <source [src]="videoContentSrc" type="video/mp4">
            <!-- <source src="http://asadsify16448.s3.ap-south-1.amazonaws.com/evx-application-videos/sample-video-126mb.mp4" type="video/mp4"> -->

          </video>
        </vg-player>
      </div>
      <div class="col-4 contentsContainer">
        <div #imhere class="imhere" id="imhereDiv">

        </div>
      </div>

      <ng-template #modalData let-modal>
        <div class="modal-header">
          <h4 class="modal-title" id="modal-basic-title">Add Chapter</h4>
          <button type="button" class="btn btn-raised close-button topright" aria-label="Close"
            (click)="modal.dismiss('Cross click')">
            <i class="ft-x"></i>
          </button>
        </div>
        <div class="modal-body">
          <form *ngIf="frameIsReady;else frameLoadingSection" [formGroup]="addChapterForm"
            (ngSubmit)="createNewChapter()">

            <div class="row justify-content-center">
              <div class="col-6">
                <label>Title</label><span class="error_msg"> * </span>

                <div class="form-group">
                  <input maxlength="50" placeholder="Enter title" type="text" formControlName="title"
                    class="form-control"
                    [ngClass]="{ 'is-invalid': formSubmitted && addChapterFormData.title.errors }" />
                  <div *ngIf="formSubmitted && addChapterFormData.title.errors" class="invalid-feedback">
                    <div *ngIf="addChapterFormData.title.errors.required">Title is required</div>
                  </div>
                </div>
              </div>
              <div class="col-6">
                <label>Timestamp</label><span class="error_msg"> * </span>

                <div class="form-group">
                  <input placeholder="Enter timestamp" readonly type="text" formControlName="timestamp"
                    class="form-control"
                    [ngClass]="{ 'is-invalid': formSubmitted && addChapterFormData.timestamp.errors }" />

                  <input type="hidden" formControlName="actualTime" />

                  <div *ngIf="formSubmitted && addChapterFormData.timestamp.errors" class="invalid-feedback">
                    <div *ngIf="addChapterFormData.timestamp.errors.required">Timestamp is required</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row justify-content-center">
              <div class="col-12">
                <label>Description</label><span class="error_msg"> * </span>
              </div>
              <div class="col-12">
                <div class="form-group">

                  <ckeditor #contentDesc maxlength="5000" formControlName="description" name="description"
                language="en" [config]="ckEditorConfig"
                [ngClass]="{ 'is-invalid': formSubmitted && addChapterFormData.description.errors }">
              </ckeditor>


                  <!-- <textarea formControlName="description" class="form-control"
                    [ngClass]="{ 'is-invalid': formSubmitted && addChapterFormData.description.errors }"></textarea> -->
                  <div *ngIf="formSubmitted && addChapterFormData.description.errors" class="invalid-feedback">
                    <div *ngIf="addChapterFormData.description.errors.required">Description is required</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-12">
                <label for="files" class="btn btn-danger-themed float-right">Upload custom thumbnail</label>
                <input id="files" style="visibility:hidden;" type="file" accept="image/*" formControlName="posterImage" (change)="showPreview($event)" />
              </div>
              <div class="col-3" *ngIf="imageURL == undefined || imageURL == ''">
                <div>Thumbnail</div>
                <img [src]="videoDataURI" style="margin-top: 10px;" width="104px" height="104px" />
              </div>

              <div class="col-3 imagePreview">
                <div *ngIf="imageURL && imageURL !== ''">Thumbnail</div>
                <img [src]="imageURL" style="margin-top: 10px;" *ngIf="imageURL && imageURL !== ''" />
              </div>
              
            </div>

            <div class="row">
              <div class="col-12">
                <div class="form-group">
                  <button class="float-right btn btn-danger-themed" type="submit" [disabled]="addChapterForm.invalid">Add Chapter</button>
                </div>
              </div>
            </div>
          </form>

          <ng-template #frameLoadingSection>
            <div class="row" style="height: 50vh;">
              <div class="col-12">
                <label style="width: 100%;
                height: 50vh;
                line-height: 50vh;
                padding: 0;
                text-align: center;">Video Thumbnail is loading.... please wait</label>
                <!-- <div class="loader"></div> -->
              </div>
            </div>
          </ng-template>
        </div>
      </ng-template>
    </div>

    <div class="row" style="margin-top: 20px;">
      <div class="col-8">
        <button id="addChapterBtn" type="button" class="btn btn-danger-themed float-right" (click)="open(modalData)">Add Chapter</button>

        <div class="form-group" style="clear: both;">
          <label>Glossary</label><span class="error_msg"> * </span>

          <div class="form-group">
            <textarea id="glossary" class="form-control"></textarea>
            <!-- <div *ngIf="formSubmitted && addChapterFormData.description.errors" class="invalid-feedback">
                <div *ngIf="addChapterFormData.description.errors.required">Description is required</div>
              </div> -->
          </div>
        </div>
      </div>
      <div class="col-4" *ngIf="chapters.length">
        <div style="position: absolute;right:20px;bottom:0;">
          <!-- <button class="btn btn-primary-themed" style="margin-right: 10px;" (click)="this.showCreateChapterForm=false;">Back</button> -->

          <button class="btn btn-danger-themed" style="margin-right: 10px;" type="button"
            (click)="finalData()">Submit</button>
          <button class="btn btn-primary-themed">Preview</button>
        </div>
      </div>
    </div>
  </div>
</div>
